(()=>{"use strict";class e{constructor(){this.coordinates=[{row:0,column:0,side:["top","left"]},{row:0,column:1,side:["top","right"]},{row:1,column:0,side:["bottom","left"]},{row:1,column:1,side:["bottom","right"]}],this.color="yellow"}moveDown(){this.coordinates.forEach((e=>{e.row++}))}moveRight(){this.coordinates.forEach((e=>{e.column++}))}moveLeft(){this.coordinates.forEach((e=>{e.column--}))}rotateRight(){}rotateLeft(){}validMoveRight(){return this.coordinates.filter((e=>e.side.includes("right"))).every((e=>{const{column:t}=e;return t+1<=9}))}validMoveLeft(){return this.coordinates.filter((e=>e.side.includes("left"))).every((e=>{const{column:t}=e;return t-1>=0}))}validMoveDown(e){return this.coordinates.filter((e=>e.side.includes("bottom"))).every((t=>{const{row:r,column:o}=t,c=r+1;if(c<=19)return"black"===e[c][o]}))}clearCoordinates(e){this.coordinates=this.coordinates.filter((t=>{const{row:r}=t;return!e.includes(r)}))}}const t=new createjs.Stage("tetris"),r=new class{constructor(e){const t=[];for(let e=0;e<20;e++){const e=[];for(let t=0;t<10;t++)e.push("black");t.push(e)}this.gameBoard=t,this.currentPiece=null,this.droppedPieces=[],this.stage=e}render(){this.stage.removeAllChildren(),this.gameBoard.forEach(((e,t)=>{e.forEach(((e,r)=>{const o=new createjs.Shape;o.graphics.beginFill(e).drawRect(30*r,30*t,30,30),this.stage.addChild(o)}))})),this.stage.update()}updateGrid(){this.currentPiece.coordinates.forEach((e=>{const{row:t,column:r}=e;this.gameBoard[t][r]=this.currentPiece.color}))}startGame(){this.createNewPiece()}isCurrentPieceStuck(e){return!this.currentPiece.validMoveDown(e)}createNewPiece(){const t=new e;this.currentPiece=t,this.droppedPieces.push(t)}calculateCompletedRows(){const e=[];return this.gameBoard.forEach(((t,r)=>{t.every((e=>"black"!==e))&&e.push(r)})),e}clearGameBoardRows(e){e.forEach((e=>{this.gameBoard[e]=new Array(10).fill("black")}))}}(t);r.startGame();const o=()=>{r.currentPiece.coordinates.forEach((e=>{const{row:t,column:o}=e;r.gameBoard[t][o]="black"}))};document.addEventListener("keydown",(e=>{if(e.preventDefault(),39===e.keyCode&&r.currentPiece.validMoveRight()?(o(),r.currentPiece.moveRight()):37===e.keyCode&&r.currentPiece.validMoveLeft()?(o(),r.currentPiece.moveLeft()):40===e.keyCode&&r.currentPiece.validMoveDown(r.gameBoard)&&(o(),r.currentPiece.moveDown()),r.updateGrid(),r.render(),r.isCurrentPieceStuck(r.gameBoard)){const e=r.calculateCompletedRows();e.length>0&&(r.droppedPieces.forEach((t=>{t.clearCoordinates(e)})),r.clearGameBoardRows(e)),r.createNewPiece(),r.updateGrid(),r.render(),console.log(r)}})),window.onload=()=>{const e=new createjs.Shape;e.graphics.beginFill("#000000").drawRect(0,0,300,600),t.addChild(e),r.updateGrid(),r.render(),console.log(r)}})();